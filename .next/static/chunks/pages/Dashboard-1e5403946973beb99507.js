(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[156],{4061:function(e,t,n){"use strict";var r=n(1428);t.Z=(0,r.buildRpcClient)({resolverName:"logout",resolverType:"mutation",routePath:"/api/rpc/logout"})},9375:function(e,t,n){"use strict";n.d(t,{h:function(){return g}});var r=n(809),o=n.n(r),a=n(266),c=n(6065),i=n(720),l=n.n(i),s=n(4061),u=n(2540),d=n(1428),h=n(3413),p=n(4753),f=n(1642),m=n(4065),v=n(7294),b=n(5893),g=function(e){var t=e.children,n=e.displayBackButton,r=void 0!==n&&n,i=(0,d.useMutation)(s.Z),g=(0,c.Z)(i,1)[0],x=(0,u.useRouter)(),j=t.length>1?"750px":"600px";console.log(j);var _=(0,m.a)("(min-width: ".concat(j,") and (max-width: 900px)")),y=(0,m.a)("(max-width: ".concat(j,")")),w=(0,v.useState)(!1),k=w[0],C=w[1];console.log({tabletScreen:_,phoneScreen:y});var N=v.Children.map(t,(function(e){return(0,v.isValidElement)(e)?(0,v.cloneElement)(e,{compact:_}):e}));return r&&!y&&N.push((0,v.cloneElement)((0,b.jsx)(h.z,{onClick:function(){return x.back()},children:"Retour"}),{compact:_})),console.log(t.length),y?(0,b.jsxs)("header",{className:l().header,children:[(0,b.jsx)("p",{children:"Formulaire"}),(0,b.jsxs)("div",{className:l().childrenDiv,children:[(0,b.jsx)(h.z,{compact:!0,onClick:function(){return x.back()},children:"Retour"}),(0,b.jsx)(p.O,{opened:k,onClick:function(){return C((function(e){return!e}))},title:"title"}),(0,b.jsx)(f.d,{position:"right",opened:k,onClose:function(){return C(!1)},title:"Vue d'ensemble",padding:"xl",overlayOpacity:.55,overlayBlur:3,children:(0,b.jsxs)("div",{className:l().drawer,children:[N,(0,b.jsx)("div",{}),(0,b.jsx)(h.z,{onClick:(0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:case"end":return e.stop()}}),e)}))),compact:_,children:"D\xe9connexion"})]})})]})]}):(0,b.jsxs)("header",{className:l().header,children:[(0,b.jsx)("p",{children:"Formulaire"}),(0,b.jsxs)("div",{className:l().childrenDiv,children:[N," | ",(0,b.jsx)(h.z,{onClick:(0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,g();case 2:case"end":return e.stop()}}),e)}))),compact:_,children:"D\xe9connexion"})]})]})}},6673:function(e,t,n){"use strict";n.d(t,{i:function(){return m}});var r=n(2809),o=n(7294),a=n(9521),c=n(233),i=n(7683),l=n.n(i),s=n(5893);function u(e){var t=e.preGlobalFilteredRows,n=e.globalFilter,r=e.setGlobalFilter,c=(e.searchValue,t.length),i=(0,o.useState)(n),u=i[0],d=i[1],h=(0,a.useAsyncDebounce)((function(e){r(e||void 0)}),200);return(0,s.jsx)("div",{className:l().searchDiv,children:(0,s.jsx)("input",{className:l().searchInput,value:u||"",onChange:function(e){d(e.target.value),h(e.target.value)},placeholder:"Rechercher dans ".concat(c," fiches")})})}function d(e){var t=e.column,n=t.filterValue,r=t.preFilteredRows,o=t.setFilter;r.length;return(0,s.jsx)("input",{value:n||"",onChange:function(e){o(e.target.value||void 0)},placeholder:"Rechercher"})}function h(e,t,n){return(0,c.default)(e,n,{keys:[function(e){return e.values[t]}]})}function p(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function f(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach((function(t){(0,r.Z)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}h.autoRemove=function(e){return!e};var m=function(e){var t=e.tableColumns,n=e.tableData,r=e.onRowClickFn,c=e.externalSearch,i=void 0===c?"":c,p=e.hideInternalSearch,m=void 0!==p&&p,v=e.sectionTitle;(0,o.useEffect)((function(){F(i)}),[i]),console.log({tableColumns:t,tableData:n,onRowClickFn:r,externalSearch:i,hideInternalSearch:m});var b=(0,o.useMemo)((function(){return n}),[n]),g=(0,o.useMemo)((function(){return t}),[]),x=(0,o.useMemo)((function(){return{fuzzyText:h,text:function(e,t,n){return e.filter((function(e){var r=e.values[t];return void 0===r||String(r).toLowerCase().startsWith(String(n).toLowerCase())}))}}}),[]),j=(0,o.useMemo)((function(){return{Filter:d}}),[]),_=(0,a.useTable)({columns:g,data:b,defaultColumn:j,filterTypes:x},a.useGlobalFilter,a.useSortBy),y=_.getTableProps,w=_.getTableBodyProps,k=_.headerGroups,C=_.rows,N=_.prepareRow,S=_.state,R=_.visibleColumns,P=_.preGlobalFilteredRows,F=_.setGlobalFilter;return 0===C.length&&m?(0,s.jsx)(s.Fragment,{}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("p",{className:l().sectionTitle,children:v}),(0,s.jsxs)("table",f(f({className:l().table},y()),{},{cellSpacing:"0",children:[(0,s.jsxs)("thead",{children:[(0,s.jsx)("tr",{children:(0,s.jsx)("th",{className:!1===m?l().dashboardSearchDiv:"",colSpan:R.length,style:{textAlign:"left"},children:!m&&(0,s.jsx)(u,{preGlobalFilteredRows:P,globalFilter:S.globalFilter,setGlobalFilter:F})})}),!m&&(0,s.jsx)("tr",{children:(0,s.jsx)("th",{colSpan:R.length,style:{textAlign:"left",height:40}})}),k.map((function(e,t){return(0,s.jsx)("tr",f(f({},e.getHeaderGroupProps()),{},{children:e.headers.map((function(e,t){return(0,s.jsx)("th",f(f({className:l().th},e.getHeaderProps(e.getSortByToggleProps())),{},{children:e.render("Header")}),t)}))}),t)}))]}),(0,s.jsx)("tbody",f(f({className:l().tBody},w()),{},{children:C.map((function(e,t){return N(e),(0,s.jsx)("tr",f(f({className:m?l().tr:l().trMain},e.getRowProps()),{},{onClick:function(){r&&r(e.original.boatId)},children:e.cells.map((function(e,t){return(0,s.jsx)("td",f(f({className:l().td},e.getCellProps()),{},{children:e.render("Cell")}),t)}))}),t)}))}))]}))]})}},3874:function(e,t,n){"use strict";var r=n(6065),o=(n(2540),n(1428)),a=n(9527),c=n(4061),i=n(5893),l=function(e){var t=e.title,n=e.children,l=(0,o.useMutation)(c.Z);(0,r.Z)(l,1)[0];return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(a.Head,{children:[(0,i.jsx)("title",{children:t||"classemini"}),(0,i.jsx)("link",{rel:"icon",href:"/favicon.ico"})]}),n]})};l.authenticate={redirectTo:"/"},t.Z=l},6390:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return y}});var r=n(809),o=n.n(r),a=n(266),c=n(2540),i=(n(1664),n(3874)),l=n(3413),s=n(6065),u=n(1428),d=n(7294),h=n(7305),p=n(9483),f=n(4922),m=n(6673),v=n(5388),b=n(4403),g=n(5893),x=function(){var e=(0,c.useRouter)(),t=(0,u.usePaginatedQuery)(h.Z,{orderBy:{boatId:"desc"},select:{id:!0,boatId:!0,skipperName:!0,boatType:!0,completed:!0,form:!1}}),n=(0,s.Z)(t,1)[0],r=n.sheets,i=(n.hasMore,(0,d.useState)([])),l=i[0],x=i[1],j=(0,u.useMutation)(v.Z),_=(0,s.Z)(j,1)[0],y=(0,u.useMutation)(b.Z),w=(0,s.Z)(y,1)[0];(0,d.useEffect)((function(){console.log({window:window,navigator:navigator});var e=navigator;e.onLine||(0,f.c0)({message:"You are".concat(e.onLine?"":"n't"," online"),color:"red"}),p.keys().then((function(e){console.log("keys:",e),x(e)})).catch((function(e){return console.log(e)}))}),[]),(0,d.useEffect)((function(){console.log({sheets:r});var e=r.map((function(e,t){return e.boatId}));console.log(e),l.forEach((function(t){try{console.log({key:t}),p.getItem(t).then(function(){var n=(0,a.Z)(o().mark((function n(r){var a;return o().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(console.log({sheet:r}),!e.includes(parseInt(t))){n.next=8;break}return console.log("update"),n.next=5,w(r);case 5:a=n.sent,n.next=12;break;case 8:return console.log("Create"),n.next=11,_(r);case 11:a=n.sent;case 12:return console.log({status:a}),n.abrupt("return",a);case 14:case"end":return n.stop()}}),n)})));return function(e){return n.apply(this,arguments)}}()).then((function(e){p.removeItem(e.boatId).then((function(e){return console.log({suc:e},"removed")})).catch((function(e){return console.log(e)}))}))}catch(n){console.log({error:n})}}))}),[l]);var k=[{Header:function(){return(0,g.jsx)("div",{style:{textAlign:"left"},children:"Num\xe9ro bateau"})},accessor:"boatId"},{Header:"Skipper(s)",accessor:"skipperName"},{Header:"Proto / S\xe9rie",accessor:"boatType"},{id:"completed",Header:function(){return(0,g.jsx)("div",{style:{textAlign:"right"},children:"Formulaire compl\xe9t\xe9"})},accessor:function(e){return e.completed?"Oui":"Non"}}];return 0===r.length?(0,g.jsx)("main",{children:(0,g.jsx)("p",{style:{textAlign:"center",paddingTop:"30%"},children:"Aucun formulaire dans la base de donn\xe9es"})}):(0,g.jsxs)(g.Fragment,{children:[l,(0,g.jsx)(m.i,{tableColumns:k,tableData:r,onRowClickFn:function(t){return e.push("/Reader?boatId=".concat(t))}})]})},j=n(9375),_=function(){console.log({Routes:c.Routes});var e=(0,c.useRouter)();return(0,g.jsxs)("div",{children:[(0,g.jsxs)(j.h,{children:[(0,g.jsx)(l.z,{onClick:function(){return e.push("/PrefillPage")},children:"Nouveau formulaire"}),(0,g.jsx)(l.z,{disabled:!0,onClick:(0,a.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),children:"Admin : modifier le formulaire"})]}),(0,g.jsx)("main",{children:(0,g.jsx)(d.Suspense,{fallback:(0,g.jsx)("main",{children:"Chargement des listes"}),children:(0,g.jsx)(x,{})})})]})};_.getLayout=function(e){return(0,g.jsx)(i.Z,{title:"Tableau de bord",children:e})};var y=_},5388:function(e,t,n){"use strict";var r=n(1428);t.Z=(0,r.buildRpcClient)({resolverName:"createSheet",resolverType:"mutation",routePath:"/api/rpc/createSheet"})},4403:function(e,t,n){"use strict";var r=n(1428);t.Z=(0,r.buildRpcClient)({resolverName:"updateSheet",resolverType:"mutation",routePath:"/api/rpc/updateSheet"})},7305:function(e,t,n){"use strict";var r=n(1428);t.Z=(0,r.buildRpcClient)({resolverName:"getSheets",resolverType:"query",routePath:"/api/rpc/getSheets"})},3785:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/Dashboard",function(){return n(6390)}])},720:function(e){e.exports={header:"header_header__3m5QB",childrenDiv:"header_childrenDiv__1Qc7T",drawer:"header_drawer__1URdt"}},7683:function(e){e.exports={table:"table_table__1VsWa",tHead:"table_tHead__3EnNf",tr:"table_tr__2LyUn",trMain:"table_trMain__3VlzN",td:"table_td__3YyRk",tBody:"table_tBody__1aa-I",searchDiv:"table_searchDiv__1Ve5F",dashboardSearchDiv:"table_dashboardSearchDiv__8vBNv",searchInput:"table_searchInput__3y6BB",sectionTitle:"table_sectionTitle__eSXNM"}}},function(e){e.O(0,[642,483,695,774,888,179],(function(){return t=3785,e(e.s=t);var t}));var t=e.O();_N_E=t}]);